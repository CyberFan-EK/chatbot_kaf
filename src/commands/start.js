const words = require('../../word');
const { Markup } = require('telegraf');

module.exports = (bot) => {
  bot.start((ctx) => {
    if (!chatIdUsers.includes(ctx.chat.id)) chatIdUsers.push(ctx.chat.id);
    const buttonsStart = {
      parse_mode: 'HTML',
      ...Markup.inlineKeyboard([Markup.button.callback('–ü–æ—á–∞—Ç–∏', '–ü–æ—á–∞—Ç–∏')]),
    };
    ctx.reply(
      `–ü—Ä–∏–≤—ñ—Ç, ${ctx.message.from.first_name}!üëã –Ø –§—ñ–Ω–¢–ï–ö–∞—à–Ω—ñ–∫ - —á–∞—Ç-–±–æ—Ç –∫–∞—Ñ–µ–¥—Ä–∏ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–æ—ó –µ–∫–æ–Ω–æ–º—ñ–∫–∏, –ø—ñ–¥–ø—Ä–∏—î–º–Ω–∏—Ü—Ç–≤–∞ —Ç–∞ —Ñ—ñ–Ω–∞–Ω—Å—ñ–≤ —ñ —è –≥–æ—Ç–æ–≤–∏–π –ø–æ—Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑ —Ç–æ–±–æ—é) –¢–∏—Å–Ω–∏ "–ü–æ—á–∞—Ç–∏" —Ç–∞ –ø–æ—á–∏–Ω–∞–π —Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—å`,
      buttonsStart
    );
  });

  const helpMessage = `
  –ü–µ—Ä–µ–ª—ñ–∫ –∑–Ω–∞–π–æ–º–∏—Ö –∫–æ–º–∞–Ω–¥
  /start - —Å—Ç–∞—Ä—Ç—É–≤–∞—Ç–∏ –±–æ—Ç–∞
  /help - –∫–æ–º–∞–Ω–¥–∏, —è–∫—ñ —è –∑–Ω–∞—é
  /location - –¥–µ –º–∏ –∑–Ω–∞—Ö–æ–¥–∏–º–æ—Å—å 
  
  `;
  bot.help((ctx) => {
    ctx.reply(helpMessage);
  });

  bot.command('location', (ctx) => {
    bot.telegram.sendLocation(ctx.chat.id, 47.8606, 35.102017);
    ctx.reply(`–ê–¥—Ä–µ—Å–∞: 69006, –º. –ó–∞–ø–æ—Ä—ñ–∂–∂—è, –ø—Ä–æ—Å–ø. –°–æ–±–æ—Ä–Ω–∏–π, 226`);
  });

  bot.hears(words.wordsStartMenu, getStartMenu);

  function getStartMenu(ctx) {
    const buttonsNext = Markup.keyboard([
      ['üë©‚Äçüíª –ê–±—ñ—Ç—É—Ä—ñ—î–Ω—Ç'],
      ['üìà –°—Ç—É–¥–µ–Ω—Ç'],
      ['üë®‚Äçüè´ –í–∏–∫–ª–∞–¥–∞—á—ñ'],
      ['üìë –ó–∞–ª–∏—à–∏—Ç–∏ –∞–Ω–∫–µ—Ç—É'],
    ])
      .oneTime()
      .resize();

    ctx.reply(
      `–Ø–∫—â–æ —Ç–∏ –∞–±—ñ—Ç—É—Ä—ñ—î–Ω—Ç —ñ —É —Ç–µ–±–µ —î –∑–∞–ø–∏—Ç–∞–Ω–Ω—è —â–æ–¥–æ –≤—Å—Ç—É–ø—É —á–∏ –Ω–∞–≤—á–∞–Ω–Ω—è –Ω–∞ –Ω–∞—à—ñ–π –∫–∞—Ñ–µ–¥—Ä—ñ, —Ç–æ —Ç–∏—Å–Ω–∏ "–ê–±—ñ—Ç—É—Ä—ñ—î–Ω—Ç".
    
    –Ø–∫—â–æ —Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç —ñ —Ö–æ—á–µ—à –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —â–æ–¥–æ –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É, —Ç–æ —Ç–∏—Å–Ω–∏ "–°—Ç—É–¥–µ–Ω—Ç".
    
    –Ø–∫—â–æ —Ç–∏ –≤–∏–∫–ª–∞–¥–∞—á —ñ —Ö–æ—á–µ—à –±—É—Ç–∏ –≤ –∫—É—Ä—Å—ñ –ø–æ–¥—ñ–π, —Ç–æ —Ç–∏—Å–Ω–∏  "–í–∏–∫–ª–∞–¥–∞—á".  
    
    –ê —è–∫—â–æ —É —Ç–µ–±–µ —î —ñ–Ω—à—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è —á–∏ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó, —Ç–æ —Ç–∏—Å–Ω–∏ –Ω–∞ "–ù–∞–ø–∏—Å–∞—Ç–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É" —Ç—É—Ç —á–∏ —É –≥–æ–ª–æ–≤–Ω–æ–º—É –º–µ–Ω—é —ñ –ø–∏—à–∏ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è - –º–∏ –ø—Ä–æ—á–∏—Ç–∞—î–º–æ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–º–æ —è–∫ —Ç—ñ–ª—å–∫–∏ –º–∞—Ç–∏–º–µ–º–æ –∑–º–æ–≥—É.
      
    –©–æ–± –≤—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—å –≤—ñ–¥ –±–æ—Ç–∞, —É –±—É–¥—å-—è–∫–∏–π –º–æ–º–µ–Ω—Ç –ø–∏—à–∏ —Å–ª–æ–≤–æ "stop".`,
      buttonsNext
    );
  }
};
